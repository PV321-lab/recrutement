<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <title>Enregistrement des invités</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <!-- Firebase -->
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>

  <style>
    body{font-family:Arial;background:#f0f2f5;margin:20px}
    h2{text-align:center}
    .card{background:#fff;padding:16px;border-radius:10px;box-shadow:0 2px 8px rgba(0,0,0,.15);margin-bottom:16px}
    label{display:block;margin-top:10px;font-weight:bold}
    input,button{width:100%;padding:10px;margin-top:6px;font-size:16px}
    button{background:#007bff;color:#fff;border:none;border-radius:8px;cursor:pointer}
    button:disabled{opacity:.6}
    .banner{padding:10px;border-radius:8px;margin-bottom:10px;font-weight:bold}
    .ok{background:#e6f4ea;color:#137333}
    .err{background:#fce8e6;color:#a50e0e}
    .hidden{display:none}
  </style>
</head>
<body>

<h2>Enregistrement des invités</h2>

<div id="banner" class="banner hidden"></div>

<div id="loginCard" class="card">
  <label>Email</label>
  <input type="email" id="loginUser" placeholder="email" />
  <label>Mot de passe</label>
  <input type="password" id="loginPass" placeholder="mot de passe" />
  <button onclick="login()">Connexion</button>
</div>

<div id="adminPanel" class="card hidden">
  <h3>Administrateur connecté</h3>
  <button onclick="logout()">Déconnexion</button>
</div>

<div id="userPanel" class="card hidden">
  <h3>Utilisateur connecté</h3>
  <button onclick="logout()">Déconnexion</button>
</div>

<script>
const firebaseConfig = {
  apiKey: "AIzaSyC6uSDTNCuw5sHNVaNgq0EzJqJZ9jgic7U",
  authDomain: "dddiii-2b58b.firebaseapp.com",
  databaseURL: "https://dddiii-2b58b-default-rtdb.asia-southeast1.firebasedatabase.app",
  projectId: "dddiii-2b58b",
  storageBucket: "dddiii-2b58b.firebasestorage.app",
  messagingSenderId: "721468171485",
  appId: "1:721468171485:web:420e2e0ab98b95fa2ae734",
  measurementId: "G-QGFM2N76VK"
};

firebase.initializeApp(firebaseConfig);

const auth = firebase.auth();
const database = firebase.database();

function showBanner(type, text) {
  const b = document.getElementById("banner");
  b.className = "banner " + type;
  b.textContent = text;
  b.classList.remove("hidden");
}

function login() {
  const email = document.getElementById("loginUser").value.trim();
  const password = document.getElementById("loginPass").value.trim();

  if (!email || !password) {
    showBanner("err", "Email et mot de passe obligatoires");
    return;
  }

  auth.signInWithEmailAndPassword(email, password)
    .then(userCredential => {
      showBanner("ok", "Connexion réussie");

      document.getElementById("loginCard").classList.add("hidden");

      if (email === "g.marouane@outlook.fr") {
        document.getElementById("adminPanel").classList.remove("hidden");
      } else {
        document.getElementById("userPanel").classList.remove("hidden");
      }
    })
    .catch(error => {
      showBanner("err", "Erreur : " + error.message);
    });
}

function logout() {
  auth.signOut().then(() => {
    document.getElementById("adminPanel").classList.add("hidden");
    document.getElementById("userPanel").classList.add("hidden");
    document.getElementById("loginCard").classList.remove("hidden");
    showBanner("ok", "Déconnecté");
  });
}
</script>

</body>
</html>