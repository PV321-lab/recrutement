<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Signature</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            font-family: 'Arial', sans-serif;
            padding: 20px;
        }
        
        .signature-container {
            width: 100%;
            max-width: 700px;
            background: white;
            border-radius: 20px;
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.1);
            padding: 30px;
            text-align: center;
        }
        
        .signature-title {
            color: #2d3436;
            margin-bottom: 25px;
            font-size: 1.8rem;
            font-weight: 600;
        }
        
        .signature-canvas {
            width: 100%;
            height: 350px;
            background: #f8f9fa;
            border: 3px dashed #a5b1c2;
            border-radius: 15px;
            margin-bottom: 25px;
            cursor: crosshair;
            touch-action: none;
            transition: all 0.3s ease;
        }
        
        .signature-canvas:hover {
            border-color: #74b9ff;
        }
        
        .signature-canvas.active {
            border: 3px solid #0984e3;
            background: #fff;
        }
        
        .save-button {
            background: linear-gradient(135deg, #0984e3 0%, #74b9ff 100%);
            color: white;
            border: none;
            padding: 18px 40px;
            font-size: 1.2rem;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 5px 15px rgba(116, 185, 255, 0.4);
            font-weight: 600;
            letter-spacing: 0.5px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            margin: 0 auto;
            min-width: 250px;
        }
        
        .save-button:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(116, 185, 255, 0.6);
        }
        
        .save-button:active {
            transform: translateY(-1px);
        }
        
        .save-button:disabled {
            background: #b2bec3;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }
        
        .button-icon {
            font-size: 1.4rem;
        }
        
        .signature-notice {
            color: #636e72;
            font-size: 0.9rem;
            margin-top: 15px;
            font-style: italic;
        }
        
        @media (max-width: 768px) {
            .signature-canvas {
                height: 300px;
            }
            
            .signature-container {
                padding: 20px;
            }
            
            .save-button {
                padding: 15px 30px;
                font-size: 1.1rem;
            }
        }
        
        @media (max-width: 480px) {
            .signature-canvas {
                height: 250px;
            }
            
            .signature-title {
                font-size: 1.5rem;
            }
        }
    </style>
</head>
<body>
    <div class="signature-container">
        <h1 class="signature-title">Signez ici</h1>
        
        <canvas id="signatureCanvas" class="signature-canvas">
            Votre navigateur ne supporte pas les signatures digitales.
        </canvas>
        
        <button id="saveButton" class="save-button" disabled>
            <span class="button-icon">üíæ</span>
            <span>Enregistrer la signature</span>
        </button>
        
        <p class="signature-notice">Signez avec votre doigt, votre souris ou votre stylet</p>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // R√©cup√©ration des √©l√©ments
            const canvas = document.getElementById('signatureCanvas');
            const saveButton = document.getElementById('saveButton');
            const ctx = canvas.getContext('2d');
            
            let isDrawing = false;
            let lastX = 0;
            let lastY = 0;
            let hasSignature = false;
            
            // Ajuster la taille du canvas
            function resizeCanvas() {
                const rect = canvas.getBoundingClientRect();
                canvas.width = rect.width;
                canvas.height = rect.height;
                
                // R√©initialiser le dessin
                clearCanvas();
            }
            
            // Initialiser le canvas
            resizeCanvas();
            window.addEventListener('resize', resizeCanvas);
            
            // Configurer le style de dessin
            ctx.strokeStyle = '#2d3436';
            ctx.lineWidth = 3;
            ctx.lineCap = 'round';
            ctx.lineJoin = 'round';
            
            // Fonction pour d√©marrer le dessin
            function startDrawing(e) {
                isDrawing = true;
                canvas.classList.add('active');
                saveButton.disabled = true;
                
                const coords = getCoordinates(e);
                [lastX, lastY] = [coords.x, coords.y];
                
                // Commencer √† dessiner un point
                ctx.beginPath();
                ctx.arc(lastX, lastY, ctx.lineWidth/2, 0, Math.PI * 2);
                ctx.fill();
            }
            
            // Fonction pour dessiner
            function draw(e) {
                if (!isDrawing) return;
                
                e.preventDefault();
                
                const coords = getCoordinates(e);
                const currentX = coords.x;
                const currentY = coords.y;
                
                // Dessiner la ligne
                ctx.beginPath();
                ctx.moveTo(lastX, lastY);
                ctx.lineTo(currentX, currentY);
                ctx.stroke();
                
                // Mettre √† jour les derni√®res coordonn√©es
                [lastX, lastY] = [currentX, currentY];
            }
            
            // Fonction pour arr√™ter le dessin
            function stopDrawing() {
                if (!isDrawing) return;
                
                isDrawing = false;
                canvas.classList.remove('active');
                hasSignature = true;
                saveButton.disabled = false;
            }
            
            // Fonction pour obtenir les coordonn√©es
            function getCoordinates(e) {
                let x, y;
                
                if (e.type.includes('touch')) {
                    const touch = e.touches[0] || e.changedTouches[0];
                    const rect = canvas.getBoundingClientRect();
                    x = touch.clientX - rect.left;
                    y = touch.clientY - rect.top;
                } else {
                    const rect = canvas.getBoundingClientRect();
                    x = e.clientX - rect.left;
                    y = e.clientY - rect.top;
                }
                
                return {x, y};
            }
            
            // Fonction pour effacer le canvas
            function clearCanvas() {
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                hasSignature = false;
                saveButton.disabled = true;
            }
            
            // Fonction pour enregistrer la signature
            function saveSignature() {
                if (!hasSignature) {
                    alert("Veuillez d'abord signer dans la zone.");
                    return;
                }
                
                // Cr√©er un canvas temporaire optimis√© pour petite taille
                const tempCanvas = document.createElement('canvas');
                const tempCtx = tempCanvas.getContext('2d');
                
                // Taille r√©duite pour l'image finale
                tempCanvas.width = 400;
                tempCanvas.height = 200;
                
                // Fond blanc
                tempCtx.fillStyle = 'white';
                tempCtx.fillRect(0, 0, tempCanvas.width, tempCanvas.height);
                
                // Dessiner la signature redimensionn√©e
                tempCtx.drawImage(canvas, 0, 0, canvas.width, canvas.height, 0, 0, tempCanvas.width, tempCanvas.height);
                
                // Convertir en image PNG avec compression
                const imageData = tempCanvas.toDataURL('image/png', 0.7);
                
                // T√©l√©charger l'image
                const link = document.createElement('a');
                link.download = 'signature_' + new Date().getTime() + '.png';
                link.href = imageData;
                link.click();
                
                // Animation de succ√®s
                saveButton.innerHTML = '<span class="button-icon">‚úÖ</span><span>Signature enregistr√©e !</span>';
                saveButton.style.background = 'linear-gradient(135deg, #00b894 0%, #55efc4 100%)';
                
                // R√©initialiser apr√®s 2 secondes
                setTimeout(() => {
                    saveButton.innerHTML = '<span class="button-icon">üíæ</span><span>Enregistrer la signature</span>';
                    saveButton.style.background = 'linear-gradient(135deg, #0984e3 0%, #74b9ff 100%)';
                    clearCanvas();
                }, 2000);
            }
            
            // √âv√©nements pour le dessin (souris)
            canvas.addEventListener('mousedown', startDrawing);
            canvas.addEventListener('mousemove', draw);
            canvas.addEventListener('mouseup', stopDrawing);
            canvas.addEventListener('mouseout', stopDrawing);
            
            // √âv√©nements pour le dessin (tactile)
            canvas.addEventListener('touchstart', function(e) {
                e.preventDefault();
                startDrawing(e);
            });
            
            canvas.addEventListener('touchmove', function(e) {
                e.preventDefault();
                draw(e);
            });
            
            canvas.addEventListener('touchend', function(e) {
                e.preventDefault();
                stopDrawing();
            });
            
            // √âv√©nement pour le bouton d'enregistrement
            saveButton.addEventListener('click', saveSignature);
            
            // Double-clic sur le canvas pour effacer
            canvas.addEventListener('dblclick', clearCanvas);
        });
    </script>
</body>
</html>