
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <title>Test Connexion Firebase</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; background: #f5f5f5; }
    .card { background: white; padding: 20px; border-radius: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); margin-bottom: 20px; }
    button { padding: 10px 20px; background: #007bff; color: white; border: none; border-radius: 5px; cursor: pointer; }
    .success { color: green; font-weight: bold; }
    .error { color: red; font-weight: bold; }
  </style>
</head>
<body>

<div class="card">
  <h2>Test de connexion Firebase</h2>
  
  <div id="testResult">
    <p>Cliquez sur le bouton pour tester la connexion :</p>
  </div>
  
  <button onclick="testFirebase()">Tester la connexion Firebase</button>
  <button onclick="testReadData()">Tester lecture des données</button>
  <button onclick="testWriteData()">Tester écriture des données</button>
</div>

<div class="card">
  <h3>Information de connexion</h3>
  <p>URL de la base de données : <strong>https://dddiii-2b58b-default-rtdb.asia-southeast1.firebasedatabase.app/</strong></p>
  <p>Région : <strong>Asia-Southeast1</strong></p>
</div>

<script>
  const firebaseConfig = {
    apiKey: "AIzaSyDExwKQehI0-l10J1Ykq3sCR8eTTqGOH7g",
    authDomain: "dddiii-2b58b.firebaseapp.com",
    databaseURL: "https://dddiii-2b58b-default-rtdb.asia-southeast1.firebasedatabase.app",
    projectId: "dddiii-2b58b",
    storageBucket: "dddiii-2b58b.appspot.com",
    messagingSenderId: "1061640484898",
    appId: "1:1061640484898:web:9d4b74d8c9e33005efd7df"
  };

  let database = null;

  async function testFirebase() {
    const resultDiv = document.getElementById('testResult');
    resultDiv.innerHTML = '<p>⏳ Initialisation de Firebase...</p>';
    
    try {
      const app = firebase.initializeApp(firebaseConfig);
      database = firebase.database();
      
      resultDiv.innerHTML = '<p class="success">✅ Firebase initialisé avec succès !</p>';
      console.log("Firebase initialisé avec succès");
      
    } catch (error) {
      resultDiv.innerHTML = `<p class="error">❌ Erreur d'initialisation Firebase:</p>
                            <p>${error.message}</p>`;
      console.error("Erreur Firebase:", error);
    }
  }

  async function testReadData() {
    if (!database) {
      alert("Veuillez d'abord initialiser Firebase");
      return;
    }
    
    const resultDiv = document.getElementById('testResult');
    resultDiv.innerHTML = '<p>⏳ Lecture des données...</p>';
    
    try {
      const snapshot = await database.ref('test').once('value');
      
      if (snapshot.exists()) {
        const data = snapshot.val();
        resultDiv.innerHTML = `<p class="success">✅ Données lues avec succès:</p>
                              <pre>${JSON.stringify(data, null, 2)}</pre>`;
        console.log("Données lues:", data);
      } else {
        resultDiv.innerHTML = '<p class="success">✅ Aucune donnée trouvée dans /test</p>';
      }
      
    } catch (error) {
      resultDiv.innerHTML = `<p class="error">❌ Erreur de lecture:</p>
                            <p>${error.message}</p>`;
      console.error("Erreur de lecture:", error);
    }
  }

  async function testWriteData() {
    if (!database) {
      alert("Veuillez d'abord initialiser Firebase");
      return;
    }
    
    const resultDiv = document.getElementById('testResult');
    resultDiv.innerHTML = '<p>⏳ Écriture des données...</p>';
    
    try {
      const testData = {
        message: "Test de connexion Firebase",
        timestamp: new Date().toISOString(),
        status: "success"
      };
      
      await database.ref('test').set(testData);
      
      resultDiv.innerHTML = `<p class="success">✅ Données écrites avec succès!</p>
                            <pre>${JSON.stringify(testData, null, 2)}</pre>`;
      console.log("Données écrites:", testData);
      
    } catch (error) {
      resultDiv.innerHTML = `<p class="error">❌ Erreur d'écriture:</p>
                            <p>${error.message}</p>`;
      console.error("Erreur d'écriture:", error);
    }
  }

  window.onload = function() {
    console.log("Page chargée, prêt pour le test Firebase");
    console.log("Configuration Firebase:", firebaseConfig);
  };
</script>

</body>
</html>
